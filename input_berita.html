<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Berita</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
    <style>
        body {
            background-color: rgb(222, 222, 222);
            font-family: Arial, sans-serif;
        }

        .header {
            background-color: #ff5722;
            color: white; 
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo img {
            width: 40px;
            height: 40px;
            margin-right: 10px;
        }

        .container-fluid {
            padding: 20px;
        }

        .sidebar {
            padding-right: 15px;
            background-color: white;
            border-radius: 5px;
            height: fit-content;
        }

        .list-group-item {
            border-radius: 10px !important;
            margin-top: 10px;
            margin-bottom: 10px;
            border: none;
            background-color: #e9ecef;
            display: flex;
            align-items: center;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }

        .list-group-item:hover {
            background-color: #ff5722;
            color: white;
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(255, 87, 34, 0.3);
        }
        
        .list-group-item i {
            margin-right: 15px;
            font-size: 1.2em;
        }

        .content-card {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .content-card h1 {
            font-size: 2em;
            font-weight: bold;
            color: #ff5722;
            margin-bottom: 20px;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            display: block;
        }

        .form-control, .form-select {
            border-radius: 8px;
            padding: 10px;
            border: 1px solid #ced4da;
            margin-bottom: 15px;
        }

        .btn-primary {
            background-color: #ff5722;
            border-color: #ff5722;
            padding: 10px 20px;
            border-radius: 8px;
            transition: background-color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #e37200;
            border-color: #e37200;
        }

        .btn-danger {
            background-color: #dc3545;
            border-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
            border-color: #bd2130;
        }

        .news-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .news-table th, .news-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
            vertical-align: middle;
        }

        .news-table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .news-table img {
            max-width: 80px;
            max-height: 80px;
            border-radius: 5px;
            object-fit: cover;
        }

        .news-table .btn-sm {
            padding: 5px 10px;
            font-size: 0.8em;
            margin-right: 5px;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <div class="header">
        <div class="logo">
            <a href="/">
                <img src="images/Logo.png" alt="Logo">
            </a>
            <h3 class="mb-0">Temu Jurusan</h3>
        </div>
        <i class="fas fa-moon" style="float: right;"></i>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-2 sidebar">
                <div class="list-group">
                    <a href="dasboard.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-th-large"></i>
                        Dashboard
                    </a>
                    <a href="infoJurusan.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-book"></i>
                        Jurusan
                    </a>
                    <a href="recent.html" class="list-group-item list-group-item-action">
                        <i class="fas fa-history"></i>
                        Berita Terbaru
                    </a>
                    <a href="input_berita.html" class="list-group-item list-group-item-action active" style="background-color: #ff5722; color: white;">
                        <i class="fas fa-plus-circle"></i>
                        Input Berita
                    </a>
                </div>
            </div>
            <div class="col-md-10">
                <div class="content-card">
                    <h1>Manajemen Berita Jurusan</h1>

                    <form id="newsForm">
                        <input type="hidden" id="newsId">
                        <div class="mb-3">
                            <label for="newsTitle" class="form-label">Judul Berita</label>
                            <input type="text" class="form-control" id="newsTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="newsDescription" class="form-label">Deskripsi Berita</label>
                            <textarea class="form-control" id="newsDescription" rows="3" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="newsImage" class="form-label">URL Gambar (Opsional)</label>
                            <input type="text" class="form-control" id="newsImage" placeholder="e.g., images/my_news_pic.jpg or a full URL">
                        </div>
                        <div class="mb-3">
                            <label for="newsLink" class="form-label">Link Detail (Opsional)</label>
                            <input type="text" class="form-control" id="newsLink" placeholder="e.g., https://example.com/news/123">
                        </div>
                        <button type="submit" class="btn btn-primary" id="saveNewsBtn">Tambah Berita</button>
                        <button type="button" class="btn btn-secondary d-none" id="cancelEditBtn">Batal Edit</button>
                    </form>

                    <h2 class="mt-5 mb-3">Daftar Berita</h2>
                    <div class="table-responsive">
                        <table class="news-table table-striped">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Judul</th>
                                    <th>Deskripsi</th>
                                    <th>Gambar</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="newsList">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const newsForm = document.getElementById('newsForm');
            const newsIdInput = document.getElementById('newsId');
            const newsTitleInput = document.getElementById('newsTitle');
            const newsDescriptionInput = document.getElementById('newsDescription');
            const newsImageInput = document.getElementById('newsImage');
            const newsLinkInput = document.getElementById('newsLink');
            const saveNewsBtn = document.getElementById('saveNewsBtn');
            const cancelEditBtn = document.getElementById('cancelEditBtn');
            const newsListTableBody = document.getElementById('newsList');

            let newsData = []; // Array to store news objects

            // Function to generate a unique ID
            function generateId() {
                return '_' + Math.random().toString(36).substr(2, 9);
            }

            // Function to save news to localStorage
            function saveNewsToLocalStorage() {
                localStorage.setItem('recentNews', JSON.stringify(newsData));
            }

            // Function to load news from localStorage
            function loadNewsFromLocalStorage() {
                const storedNews = localStorage.getItem('recentNews');
                if (storedNews) {
                    newsData = JSON.parse(storedNews);
                } else {
                    // Populate with initial dummy data if localStorage is empty
                    newsData = [
                        { id: generateId(), title: "PENS Raih Juara Umum Kompetisi Informatika Nasional Enam Kali Berturut-turut", description: "Politeknik Elektronika Negeri Surabaya (PENS) kembali menorehkan prestasi gemilang dengan meraih juara umum kompetisi Informatika Nasional untuk keenam kalinya secara berturut-turut...", image: "https://via.placeholder.com/600x300?text=PENS+Raih+Juara", link: "#" },
                        { id: generateId(), title: "PENS Siap Dukung Literasi Digital di Kalangan Mahasiswa Surabaya", description: "Direktorat Jenderal Vokasi bersama Politeknik Elektronika Negeri Surabaya (PENS) mendukung penuh peningkatan literasi digital di kalangan mahasiswa Surabaya. Berbagai aktivitas dan informasi di dunia digital semakin meningkat...", image: "https://via.placeholder.com/600x300?text=PENS+Dukung+Literasi", link: "#" },
                        { id: generateId(), title: "Mahasiswa Singapura Belajar Teknologi dan Budaya di PENS Surabaya", description: "Delegasi mahasiswa dari Singapura berkunjung ke Politeknik Elektronika Negeri Surabaya (PENS) untuk mempelajari teknologi terbaru dan mengenal lebih dekat kebudayaan Indonesia...", image: "https://via.placeholder.com/600x300?text=Mahasiswa+Singapura+Belajar", link: "#" },
                        { id: generateId(), title: "Dari Ajang InnoWorks 2023, Inovasi Mahasiswa PENS Siap Wakili Indonesia ke Tingkat ASEAN", description: "Dalam ajang InnoWorks 2023, Politeknik Elektronika Negeri Surabaya (PENS) kembali menunjukkan taringnya. Inovasi-inovasi yang dihasilkan mahasiswa PENS berhasil lolos dan siap mewakili Indonesia ke tingkat ASEAN...", image: "https://via.placeholder.com/600x300?text=Inovasi+Mahasiswa+PENS", link: "#" }
                    ];
                    saveNewsToLocalStorage(); // Save initial data
                }
            }

            // Function to render news list
            function renderNewsList() {
                newsListTableBody.innerHTML = ''; // Clear existing list
                newsData.forEach(news => {
                    const row = newsListTableBody.insertRow();
                    row.innerHTML = `
                        <td>${news.id}</td>
                        <td>${news.title}</td>
                        <td>${news.description.substring(0, 100)}...</td>
                        <td><img src="${news.image}" alt="News Image" onerror="this.onerror=null;this.src='https://via.placeholder.com/80?text=No+Img';"></td>
                        <td>
                            <button class="btn btn-info btn-sm edit-btn" data-id="${news.id}">Edit</button>
                            <button class="btn btn-danger btn-sm delete-btn" data-id="${news.id}">Hapus</button>
                        </td>
                    `;
                });
                addEventListenersToButtons();
            }

            // Function to add event listeners to edit/delete buttons
            function addEventListenersToButtons() {
                document.querySelectorAll('.edit-btn').forEach(button => {
                    button.addEventListener('click', editNews);
                });
                document.querySelectorAll('.delete-btn').forEach(button => {
                    button.addEventListener('click', deleteNews);
                });
            }

            // Function to handle form submission (Add/Update)
            newsForm.addEventListener('submit', function(e) {
                e.preventDefault();

                const id = newsIdInput.value;
                const title = newsTitleInput.value;
                const description = newsDescriptionInput.value;
                const image = newsImageInput.value;
                const link = newsLinkInput.value;

                if (id) {
                    // Update existing news
                    const index = newsData.findIndex(news => news.id === id);
                    if (index !== -1) {
                        newsData[index] = { id, title, description, image, link };
                    }
                    saveNewsBtn.textContent = 'Tambah Berita';
                    cancelEditBtn.classList.add('d-none');
                } else {
                    // Add new news
                    newsData.push({ id: generateId(), title, description, image, link });
                }

                saveNewsToLocalStorage();
                renderNewsList();
                newsForm.reset(); // Clear form
                newsIdInput.value = ''; // Clear hidden ID
            });

            // Function to populate form for editing
            function editNews(e) {
                const idToEdit = e.target.dataset.id;
                const newsToEdit = newsData.find(news => news.id === idToEdit);

                if (newsToEdit) {
                    newsIdInput.value = newsToEdit.id;
                    newsTitleInput.value = newsToEdit.title;
                    newsDescriptionInput.value = newsToEdit.description;
                    newsImageInput.value = newsToEdit.image;
                    newsLinkInput.value = newsToEdit.link;

                    saveNewsBtn.textContent = 'Update Berita';
                    cancelEditBtn.classList.remove('d-none');
                }
            }

            // Function to cancel editing
            cancelEditBtn.addEventListener('click', function() {
                newsForm.reset();
                newsIdInput.value = '';
                saveNewsBtn.textContent = 'Tambah Berita';
                cancelEditBtn.classList.add('d-none');
            });

            // Function to delete news
            function deleteNews(e) {
                if (confirm('Apakah Anda yakin ingin menghapus berita ini?')) {
                    const idToDelete = e.target.dataset.id;
                    newsData = newsData.filter(news => news.id !== idToDelete);
                    saveNewsToLocalStorage();
                    renderNewsList();
                }
            }

            // Initial load and render
            loadNewsFromLocalStorage();
            renderNewsList();
        });
    </script>
</body>
</html>